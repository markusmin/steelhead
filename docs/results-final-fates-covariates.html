<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Markus Min" />

<meta name="date" content="2024-08-09" />

<title>Results - Final fates and covariates</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Steelhead Movement</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="structure.html">Structure</a>
</li>
<li>
  <a href="diagnostics.html">Diagnostics</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Results
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="results-detection-efficiency.html">Detection efficiency</a>
    </li>
    <li>
      <a href="results-final-fates.html">Final fates</a>
    </li>
    <li>
      <a href="results-temperature.html">Temperature</a>
    </li>
    <li>
      <a href="results-spill-days.html">Winter spill days</a>
    </li>
    <li>
      <a href="results-spill-window.html">Spill volume</a>
    </li>
    <li>
      <a href="results-year.html">Interannual differences</a>
    </li>
    <li>
      <a href="results-final-fates-covariates.html">Final fates and covariates</a>
    </li>
  </ul>
</li>
<li>
  <a href="issues.html">Outstanding issues</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Results - Final fates and covariates</h1>
<h4 class="author">Markus Min</h4>
<h4 class="date">2024-08-09</h4>

</div>


<div id="description" class="section level2">
<h2>Description</h2>
<p>This page contains how final fates are affected by different
covariate values (in particular, spill and temperature). This allows us
to understand the overall impact of these changes, when the whole
migration is taken into account.</p>
<div id="simulation-steps" class="section level3">
<h3>Simulation steps</h3>
<p>The code used to estimate the effect of covariate conditions on the
final fates of fish is very similar to the code used to estimate the
final fates of fish under different conditions. The only addition to the
final fates code are additional arguments that allow conditions to be
fixed. Conditions were fixed using the following methods:</p>
<p><em>Temperature conditions</em></p>
<p>To examine the effect of temperature, simulations were conducted
using different run years as representative of cool (25th percentile),
average (50th percentile), and warm (75th percentile) conditions. Based
on this criteria, the run years that were chosen as representative were
08/09 (cool), 19/20 (average), and 17/18 (warm). The coldest year in our
dataset is 07/08, and the hottest year in our dataset is 15/16. Here are
the median temperatures across run years:</p>
<div class="float">
<img src="site_figures/data_plots/median_temp_by_run_year_BON.png"
style="width:70.0%"
alt="Temperature conditions by run year in the Columbia River Basin." />
<div class="figcaption">Temperature conditions by run year in the
Columbia River Basin.</div>
</div>
<p><br> <br></p>
<p>Because there is some relationship between temperature and spill, for
each representative run year, both the temperature and the spill values
were pulled from a representative run year. Here are some plots showing
the relationship between temperature and spill volume, as experience by
fish:</p>
<div class="float">
<img src="site_figures/data_plots/UCH_states_dates_cov_plot.png"
style="width:70.0%"
alt="Temperature vs. spill for Upper Columbia, Hatchery fish." />
<div class="figcaption">Temperature vs. spill for Upper Columbia,
Hatchery fish.</div>
</div>
<p><br></p>
<p><img src="site_figures/data_plots/SRW_states_dates_cov_plot.png"
style="width:70.0%"
alt="Temperature vs. spill for Snake River, Wild fish." /> <br></p>
<p>It is worth noting, however, that there does not appear to be a
correlation between parameters that govern the effect of spill volume
and temperature. Here is one such representative pairs plot, in this
case showing the temperature and spill parameters for movements out of
the BON to MCN state for Walla Walla River hatchery fish.</p>
<div class="float">
<img src="site_figures/MCH_from_2_origin_2temp_v_spill_pairs_plot.png"
style="width:70.0%"
alt="Temperature vs. spill for Snake River, Wild fish." />
<div class="figcaption">Temperature vs. spill for Snake River, Wild
fish.</div>
</div>
<p><em>Winter spill conditions</em></p>
<p>The number of winter spill days at the first overshoot dam were fixed
to a sequence of values ranging from 0 to 50 days, with the simulation
re-run at each of those values.</p>
<p><em>Spill volume</em></p>
<p>To test the effects of spill volume on homing probability, the
simulation is set up to allow the spill volume over specific date ranges
at specific projects to be fixed. While the model is not time-explicit,
the simulation is set up to use the distribution of movement timing in
different states to estimate the proportion of fish that would encounter
these spill conditions.</p>
</div>
</div>
<div id="winter-spill" class="section level2">
<h2>Winter spill</h2>
<p>For the effects of winter spill, we are focusing on the following
origins, which each have high overshoot probabilities:</p>
<pre><code>- John Day River (55% MCN, 14% ICH)
- Umatilla River (40% MCN, 8% ICH)
- Walla Walla River (52% ICH, 21% LGR)
- Wenatchee River (47% RRE, 31% WEL)
- Tucannon River (44% LGR)
- Entiat River (35% WEL)
- Yakima river (13% PRA)</code></pre>
<p>These are also the populations that Shelby looked at, using the
following criteria:</p>
<blockquote>
<p>Because steelhead located further than 120 rkm from the nearest
upstream dam with adult detectors overshot at negligible rates (i.e.,
&lt;5%), we only used regression analyses to evaluate within-stock
effects for steelhead from tributaries less than 120 rkm downstream of a
dam where overshooting could be measured. These included steelhead from
the John Day, Umatilla, Walla Walla, Yakima, Wenatchee, Entiat, and
Tucannon rivers. (Richins and Skalski 2018)</p>
</blockquote>
<div id="john-day-river" class="section level4">
<h4>John Day River</h4>
<div class="float">
<img
src="site_figures/final_fates_covariates/JDR_MCN_winterspill_homing_plot_temps.png"
style="width:70.0%"
alt="Homing probability of John Day River Steelhead under three representative temperature conditions and different values of winter spill days at McNary Dam." />
<div class="figcaption">Homing probability of John Day River Steelhead
under three representative temperature conditions and different values
of winter spill days at McNary Dam.</div>
</div>
<p><br> <br></p>
<p>As a reminder, here is the plot showing the effect of winter spill on
fallback at McNary Dam for this population:</p>
<div class="float">
<img
src="site_figures/covariate_effects/spilldays/JDR_compare_fallback_MCN_spilldays.png"
style="width:70.0%"
alt="Effect of days of winter spill on post-overshoot fallback at McNary Dam for John Day River Steelhead." />
<div class="figcaption">Effect of days of winter spill on post-overshoot
fallback at McNary Dam for John Day River Steelhead.</div>
</div>
<p><br> <br></p>
</div>
<div id="umatilla-river" class="section level4">
<h4>Umatilla River</h4>
<div class="float">
<img
src="site_figures/final_fates_covariates/UMA_MCN_winterspill_homing_plot_temps.png"
style="width:70.0%"
alt="Homing probability of Umatilla River Steelhead under three representative temperature conditions and different values of winter spill days at McNary Dam." />
<div class="figcaption">Homing probability of Umatilla River Steelhead
under three representative temperature conditions and different values
of winter spill days at McNary Dam.</div>
</div>
<p><br> <br></p>
<p>As a reminder, here is the plot showing the effect of winter spill on
fallback at McNary Dam for this population:</p>
<div class="float">
<img
src="site_figures/covariate_effects/spilldays/UMA_compare_fallback_MCN_spilldays.png"
style="width:70.0%"
alt="Effect of days of winter spill on post-overshoot fallback at McNary Dam for Umatilla River Steelhead." />
<div class="figcaption">Effect of days of winter spill on post-overshoot
fallback at McNary Dam for Umatilla River Steelhead.</div>
</div>
<p><br> <br></p>
</div>
<div id="walla-walla-river" class="section level4">
<h4>Walla Walla River</h4>
<div class="float">
<img
src="site_figures/final_fates_covariates/WAWA_ICH_winterspill_homing_plot_temps.png"
style="width:70.0%"
alt="Homing probability of Walla Walla River Steelhead under three representative temperature conditions and different values of winter spill days at Ice Harbor Dam." />
<div class="figcaption">Homing probability of Walla Walla River
Steelhead under three representative temperature conditions and
different values of winter spill days at Ice Harbor Dam.</div>
</div>
<p><br> <br></p>
<p>As a reminder, here is the plot showing the effect of winter spill on
fallback at Ice Harbor Dam for this population:</p>
<div class="float">
<img
src="site_figures/covariate_effects/spilldays/WAWA_compare_fallback_ICH_spilldays.png"
style="width:70.0%"
alt="Effect of days of winter spill on post-overshoot fallback at McNary Dam for Walla Walla River Steelhead." />
<div class="figcaption">Effect of days of winter spill on post-overshoot
fallback at McNary Dam for Walla Walla River Steelhead.</div>
</div>
<p><br> <br></p>
</div>
<div id="wenatchee-river" class="section level4">
<h4>Wenatchee River</h4>
<div class="float">
<img
src="site_figures/final_fates_covariates/WEN_RRE_winterspill_homing_plot_temps.png"
style="width:70.0%"
alt="Homing probability of Wenatchee River Steelhead under three representative temperature conditions and different values of winter spill days at Rocky Reach Dam." />
<div class="figcaption">Homing probability of Wenatchee River Steelhead
under three representative temperature conditions and different values
of winter spill days at Rocky Reach Dam.</div>
</div>
<p><br> <br></p>
<p>As a reminder, here is the plot showing the effect of winter spill on
fallback at Rocky Reach Dam for this population:</p>
<div class="float">
<img
src="site_figures/covariate_effects/spilldays/WEN_compare_fallback_RRE_spilldays.png"
style="width:70.0%"
alt="Effect of days of winter spill on post-overshoot fallback at McNary Dam for Wenatchee River Steelhead." />
<div class="figcaption">Effect of days of winter spill on post-overshoot
fallback at McNary Dam for Wenatchee River Steelhead.</div>
</div>
<p><br> <br></p>
</div>
<div id="tucannon-river" class="section level4">
<h4>Tucannon River</h4>
<div class="float">
<img
src="site_figures/final_fates_covariates/TUC_LGR_winterspill_homing_plot_temps.png"
style="width:70.0%"
alt="Homing probability of Tucannon River Steelhead under three representative temperature conditions and different values of winter spill days at Lower Granite Dam." />
<div class="figcaption">Homing probability of Tucannon River Steelhead
under three representative temperature conditions and different values
of winter spill days at Lower Granite Dam.</div>
</div>
<p><br> <br></p>
<p>As a reminder, here is the plot showing the effect of winter spill on
fallback at Lower Granite Dam for this population:</p>
<div class="float">
<img
src="site_figures/covariate_effects/spilldays/TUC_compare_fallback_LGR_spilldays.png"
style="width:70.0%"
alt="Effect of days of winter spill on post-overshoot fallback at McNary Dam for Tucannon River Steelhead." />
<div class="figcaption">Effect of days of winter spill on post-overshoot
fallback at McNary Dam for Tucannon River Steelhead.</div>
</div>
<p><br> <br></p>
</div>
<div id="entiat-river" class="section level4">
<h4>Entiat River</h4>
<div class="float">
<img
src="site_figures/final_fates_covariates/ENT_WEL_winterspill_homing_plot_temps.png"
style="width:70.0%"
alt="Homing probability of Entiat River Steelhead under three representative temperature conditions and different values of winter spill days at Wells Dam." />
<div class="figcaption">Homing probability of Entiat River Steelhead
under three representative temperature conditions and different values
of winter spill days at Wells Dam.</div>
</div>
<p><br> <br></p>
<p>As a reminder, here is the plot showing the effect of winter spill on
fallback at Wells Dam for this population:</p>
<div class="float">
<img
src="site_figures/covariate_effects/spilldays/ENT_compare_fallback_WEL_spilldays.png"
style="width:70.0%"
alt="Effect of days of winter spill on post-overshoot fallback at Wells Dam for Entiat River Steelhead." />
<div class="figcaption">Effect of days of winter spill on post-overshoot
fallback at Wells Dam for Entiat River Steelhead.</div>
</div>
<p><br> <br></p>
</div>
<div id="yakima-river" class="section level4">
<h4>Yakima River</h4>
<p><br> <br></p>
<div class="float">
<img
src="site_figures/final_fates_covariates/YAK_PRA_winterspill_homing_plot_temps.png"
style="width:70.0%"
alt="Homing probability of Yakima River Steelhead under three representative temperature conditions and different values of winter spill days at Priest Rapids Dam." />
<div class="figcaption">Homing probability of Yakima River Steelhead
under three representative temperature conditions and different values
of winter spill days at Priest Rapids Dam.</div>
</div>
<p><br> <br></p>
<p>As a reminder, here is the plot showing the effect of winter spill on
fallback at Priest Rapids Dam for this population:</p>
<div class="float">
<img
src="site_figures/covariate_effects/spilldays/YAK_compare_fallback_PRA_spilldays.png"
style="width:70.0%"
alt="Effect of days of winter spill on post-overshoot fallback at Priest Rapids Dam for Yakima River Steelhead." />
<div class="figcaption">Effect of days of winter spill on post-overshoot
fallback at Priest Rapids Dam for Yakima River Steelhead.</div>
</div>
<p><br> <br></p>
</div>
</div>
<div id="spill-volume" class="section level2">
<h2>Spill volume</h2>
<div class="float">
<img
src="site_figures/final_fates_covariates/JDR_BON_spillvolume_homing_plot_temps.png"
style="width:70.0%"
alt="Homing probability of John Day River Steelhead under three representative temperature conditions with varying amounts of spill at Bonneville Dam. In this simulation, we tested the effect of 50, 100, or 150 kcfs of spill at Bonneville Dam during the period April 3 - June 30." />
<div class="figcaption">Homing probability of John Day River Steelhead
under three representative temperature conditions with varying amounts
of spill at Bonneville Dam. In this simulation, we tested the effect of
50, 100, or 150 kcfs of spill at Bonneville Dam during the period April
3 - June 30.</div>
</div>
<p><br> <br></p>
<p>As a reminder, here is the plot of spill volume vs. fallback
probability at Bonneville Dam for John Day River Steelhead (and remember
that the effect of spill volume on fallback is shared across origins
within the same DPS).</p>
<div class="float">
<img
src="site_figures/covariate_effects/spillwindow/JDR_compare_fallback_BON_spillwindow.png"
style="width:50.0%"
alt="Effect of spill volume on fallback at Bonneville Dam for John Day River Steelhead." />
<div class="figcaption">Effect of spill volume on fallback at Bonneville
Dam for John Day River Steelhead.</div>
</div>
<p><br> <br></p>
<div class="float">
<img
src="site_figures/final_fates_covariates/ENT_BON_MCN_spillvolume_homing_plot_temps.png"
style="width:70.0%"
alt="Homing probability of Entiat River Steelhead under three representative temperature conditions with varying amounts of spill at both Bonneville Dam and McNary Dam. In this simulation, we tested the consequences of four spill scenarios with 0, 50, 100, or 150 kcfs of spill at Bonneville Dam during the period April 3 - June 30 and 0, 50, 100, or 150 kcfs of spill at McNary dam during the period March 1 - March 31." />
<div class="figcaption">Homing probability of Entiat River Steelhead
under three representative temperature conditions with varying amounts
of spill at both Bonneville Dam and McNary Dam. In this simulation, we
tested the consequences of four spill scenarios with 0, 50, 100, or 150
kcfs of spill at Bonneville Dam during the period April 3 - June 30 and
0, 50, 100, or 150 kcfs of spill at McNary dam during the period March 1
- March 31.</div>
</div>
<p><br> <br></p>
<p>Here are the plots of spill volume vs. fallback at Bonneville and
McNary Dam for Entiat River Steelhead.</p>
<div class="float">
<img
src="site_figures/covariate_effects/spillwindow/ENT_compare_fallback_BON_spillwindow.png"
style="width:50.0%"
alt="Effect of spill volume on fallback at Bonneville Dam for Entiat River Steelhead." />
<div class="figcaption">Effect of spill volume on fallback at Bonneville
Dam for Entiat River Steelhead.</div>
</div>
<p><br> <br></p>
<div class="float">
<img
src="site_figures/covariate_effects/spillwindow/ENT_compare_fallback_MCN_spillwindow.png"
style="width:50.0%"
alt="Effect of spill volume on fallback at McNary Dam for Entiat River Steelhead." />
<div class="figcaption">Effect of spill volume on fallback at McNary Dam
for Entiat River Steelhead.</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
