<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Markus Min" />

<meta name="date" content="2024-02-29" />

<title>Model Structure</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Steelhead Movement</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="structure.html">Structure</a>
</li>
<li>
  <a href="diagnostics.html">Diagnostics</a>
</li>
<li>
  <a href="results.html">Results</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Model Structure</h1>
<h4 class="author">Markus Min</h4>
<h4 class="date">2024-02-29</h4>

</div>


<div id="model-states" class="section level3">
<h3>Model states</h3>
<!-- ![States in the model](/Users/markusmin/Documents/CBR/steelhead/figures/full_model_diagram.png) -->
<p><img src="site_figures/full_model_diagram.png"
alt="States in the model" /> <br></p>
</div>
<div id="covariate-structure-description" class="section level3">
<h3>Covariate structure description</h3>
<p>The covariate effects were structured in the model to test specific
hypotheses about the effects of these factors on movements of
interest:</p>
<ol style="list-style-type: decimal">
<li>Hatchery and wild origin fish have different movement patterns.</li>
<li>The natal origin of a fish influences its movement decisions after
it has entered the boundaries of its DPS.</li>
<li>The temperature experienced by a fish while in a reach of the
mainstem Columbia or Snake River influences its decision to seek cooler
refuge (either in an upstream mainstem reach or in a tributary). Fish of
different natal origins respond differently to temperature while inside
the boundaries of their DPS.</li>
<li>En-route fallback is an involuntary action that is caused by river
conditions or individual condition. Higher volumes of spill lead to
higher risk of en-route fallback.</li>
<li>Post-overshoot fallback is a voluntary action. Post-overshoot
fallback is facilitated by the presence of spill, which provides fish a
safer, surface passage route.</li>
<li>In addition to the river condition variables explicitly modeled
(temperature and spill), internanual variation in other river conditions
influences movement choices.</li>
</ol>
<p>To test these hypotheses in the modeling framework, fish from
different DPSs and of different rear types were modeled separately,
facilitating the comparison of movement probabilities along these axes.
Within a DPS/rear type combination, covariates were added for the effect
of natal origin for any movements within DPS boundaries, ensuring that
fish of different natal origins had different movement probabilities as
they neared their natal tributaries. Temperature effects were included
only for movements that were either upstream or into tributaries, as
previous studies have indicated that Steelhead respond to temperature by
seeking out colder refugia, either in tributaries (High et al. 2006) or
in upstream mainstem reaches (Richins and Skalski 2018). In contrast,
spill effects were only included for downstream (fallback) movements,
but with different structures based on whether a movement was
post-overshoot fallback or en-route fallback. Post-overshoot fallback
modeled as a function of days of winter (January, February, and March)
spill, as the presence of a spillway passage route has previously been
shown to be more important than the volume of spill for facilitating
downstream passage of adults at dams (Wertheimer and Evans 2005). In
contrast, en-route fallback was modeled as a function of the volume of
spill, as this type of fallback is assumed to be an involuntary movement
caused by hydrosystem conditions. Finally, a random effect of year was
included for movements within a fish’s DPS to account for interannual
variation that was not explicitly accounted for by the other covariates.
A random effect of year was not included for movements outside of a
fish’s DPS, as outside of the DPS, we expected individuals to behave
similarly regardless of the year.</p>
<p><br></p>
</div>
<div id="how-covariates-are-coded-in-the-model" class="section level3">
<h3>How covariates are coded in the model</h3>
<p>In addition to the effects of DPS and rear type that are estimated
via the separate estimation of model parameters for hatchery and wild
fish from each DPS, four covariates were explicitly included via
parameters in the model: origin, temperature, spill, and year.</p>
<div id="natal-origin" class="section level4">
<h4>Natal Origin</h4>
<p>To reduce the number of parameters in the model, a fixed effect of
natal origin was included only for state transitions into or out of
states within the DPS boundaries, whereas for states outside of the DPS,
all origins shared a common movement probability. This model structure
allowed the effect of unique natal origins to differentiate as they
neared natal tributaries. Natal origin was modeled as a fixed
effect.</p>
</div>
<div id="temperature" class="section level4">
<h4>Temperature</h4>
<p>Two separate temperature effects were estimated in our modeling
framework, to account for the temporal aspect of temperature. Because
temperature is strongly correlated with day of year, which has been
previously noted to influence Steelhead migration patterns (Siegel et
al. 2021), we divided the effect of temperature into a winter/spring
effect (January 1 - May 31) and a summer/fall effect (June 1 - December
31). Depending on the day of year of each movement, the temperature in
the window was either multiplied by the winter/spring temperature
parameter or the summer/fall temperature parameter. Approximately 96% of
all movements occurred in the summer/fall period.</p>
<p>The temperature effects were structured to allow a temperature effect
only for movements from a mainstem state to the mainstem state upstream
of that state, or from a mainstem state into a tributary. Furthermore,
temperature effects were structured to allow different natal origins to
have a different response to temperature within the DPS boundaries. As
such, the same origin structure was used as was used for the origin
effects - temperature effects were shared outside of a DPS, but within a
DPS each natal origin had a separately estimated parameter for the
effect of temperature on each movement. Temperature was modeled as a
fixed effect.</p>
</div>
<div id="spill" class="section level4">
<h4>Spill</h4>
<p>For the effect of the volume of spill within a window of time, only
en-route fallback movements included an effect for the volume of spill.
This parameter was shared between all origins. For the effect of the
number of days in the winter with some volume of spill, only
post-overshoot fallback movements included an effect for the number of
days of spill during the winter months. This parameter was shared
between all origins for which the movement was a post-overshoot fallback
movement. Therefore, for any fallback movement, either the effect of the
volume of spill or the number of days of winter spill was included,
depending on the relation of that dam to the fish’s natal origin. Spill
was modeled as a fixed effect.</p>
</div>
<div id="year" class="section level4">
<h4>Year</h4>
<p>Within the datasets for each of the six populations (3 DPSs x 2 rear
types), all individuals were pooled across years when fitting the model,
but a random effect of year for certain movements was included to allow
the movement probabilities to vary interannually and account for year
specific differences that weren’t captured by the covariates included in
the model. The setup for the inclusion of year effects was the same as
that for origin effects - a random effect for each year was included
only for state transitions into or out of states within the DPS
boundaries, and random effects for year were all origin specific (no
DPS-wide year effects). One reason for this modeling choice was the
computational necessity of restricting the number of movements that
receive a random effect for each of the 17 years in our dataset, as well
as needing enough data for each movement to estimate a separate effect
for each origin for each year. A second, ecological reason for this
choice was based on our a priori hypothesis that interannual differences
would mostly emerge when fish were nearing natal tributaries. Downstream
of the DPS, individuals are expected to behave similarly regardless of
the year, as all fish have natal tributaries that are upstream. Year was
modeled as a random effect.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
